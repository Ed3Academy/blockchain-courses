# å’Œä½ çš„åˆçº¦äº¤äº’

## ğŸ“’ è·å–åˆçº¦ ABI

å°±åƒæˆ‘ä»¬åœ¨ä¼ ç»Ÿå‰ç«¯å¼€å‘ä¸­ï¼Œéœ€è¦çŸ¥é“åç«¯ API çš„ urlã€å‚æ•°ç­‰ä¿¡æ¯ä¸€æ ·ï¼Œæˆ‘ä»¬ä¸åŒºå—é“¾äº¤äº’ä¹Ÿéœ€è¦è¿™æ ·çš„ä¿¡æ¯ï¼

è¿˜è®°å¾—æˆ‘ä»¬çš„åˆçº¦ç¼–è¯‘åç”Ÿæˆçš„ `artifacts` æ–‡ä»¶å¤¹å—ï¼Ÿå®ƒå°±è•´å«ç€æˆ‘ä»¬æ‰€éœ€è¦çš„æ–‡ä»¶ï¼Œè¿™ç±»æ–‡ä»¶ä¹Ÿå«ä½œ ABIã€‚

æˆ‘ä»¬å…ˆæ–°å»ºä¸€ä¸ª `abi` æ–‡ä»¶å¤¹åœ¨å‰ç«¯é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œç„¶åæˆ‘ä»¬å°†åˆçº¦é¡¹ç›®ä¸­çš„ `artifacts\contracts\MyToken.sol\MyToken.json` æ‹·è´è‡³ `abi` æ–‡ä»¶å¤¹ä¸­ã€‚

![abi.png](https://i.postimg.cc/BvdL9CsW/abi.png)

ç„¶åæˆ‘ä»¬åœ¨ `index.jsx` ä¸­å¯¼å…¥ abi æ–‡ä»¶ï¼š

```tsx
// ...
import { Card, Row, Col, Button, Typography } from "antd";
import ABI_GATE from "../abi/AirlineGate.json";
import ABI_TICKET from "../abi/TicketNft.json";
import ABI_POINT from "../abi/LoyaltyPoints.json";
import ABI_COUPON from "../abi/Coupon.json";

const { Title } = Typography;
// ...
```

## ğŸ  è·å–åˆçº¦åœ°å€

è¿˜è®°å¾—ä½ åœ¨ Mumbai Testnet ä¸Šéƒ¨ç½²çš„åˆçº¦å—ï¼Ÿé‚£æ¬¡éƒ¨ç½²çš„è¾“å‡ºåŒ…æ‹¬ä½ çš„æ™ºèƒ½åˆçº¦åœ°å€ï¼Œçœ‹èµ·æ¥åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚

```none
Deploying contracts with account:  0x9f773d11C3eABb67Bd1827a983641b37c6C6B0a5
Account balance:  200000000000000000
MyToken address:  0xe7eF8d5C50fD89AaFF85384D50774aB15f0652FC
```

å‰ç«¯é¡¹ç›®ä¸­éœ€è¦çŸ¥é“åˆçº¦åœ°å€ï¼Œæ‰èƒ½ä¸åˆçº¦è¿›è¡Œäº¤äº’ã€‚é‚£ä¹ˆæˆ‘ä»¬åœ¨ `index.jsx `ä¸­å£°æ˜å‡ ä¸ªå¸¸é‡ï¼š

```tsx
import Head from "next/head";
import styles from "../styles/Home.module.css";
import { ConnectButton } from "@rainbow-me/rainbowkit";
import MyTokenABI from "../abi/MyToken.json";

const abi = MyTokenABI.abi;
const contractAddress = '0xe7eF8d5C50fD89AaFF85384D50774aB15f0652FC';

const Home = () => {
```

## ğŸ“’ è¯»å–æ•°æ®

æˆ‘ä»¬å¯ä»¥é€šè¿‡ wagmi çš„ `useContractRead` æ¥è¯»å–æ•°æ®

```tsx
import Head from "next/head";
import styles from "../styles/Home.module.css";
import { ConnectButton } from "@rainbow-me/rainbowkit";
import MyTokenABI from "../abi/MyToken.json";
import { useContractRead, useAccount } from "wagmi";
import { useState, useEffect } from "react";
import { BigNumber } from "ethers";

const abi = MyTokenABI.abi;
const contractAddress = "0xe7eF8d5C50fD89AaFF85384D50774aB15f0652FC";

const Home = () => {
  const { address } = useAccount();
  const [mounted, setMounted] = useState(false);

  const { data: balance } = useContractRead<
    typeof abi,
    "balanceOf",
    number | BigNumber | undefined
  >({
    address: contractAddress,
    abi,
    functionName: "balanceOf",
    args: [address],
  });

  const { data: totalSupply } = useContractRead<
    typeof abi,
    "totalSupply",
    number | BigNumber | undefined
  >({
    address: contractAddress,
    abi,
    functionName: "totalSupply",
  });

  useEffect(() => {
    setMounted(true);
  }, []);

  if (!mounted) {
    return null;
  }

  return (
    <div className={styles.container}>
      <Head>
        <title>My Token Portal</title>
        <meta
          name="description"
          content="Generated by @rainbow-me/create-rainbowkit"
        />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={styles.main}>
        <ConnectButton />
        <h2>My Token</h2>
        <div className={styles.card}>
          <div>Balance</div>
          {balance && <div>{balance.toString()}</div>}
        </div>
        <div className={styles.card}>
          <div>Total Supply</div>
          {totalSupply && <div>{totalSupply.toString()}</div>}
        </div>
        <div className={styles.card}>
          <div>Mint</div>
          <div></div>
        </div>
      </main>
    </div>
  );
};

export default Home;
```

è¿™æ ·ä¸€æ¥æˆ‘ä»¬çš„é¡µé¢å°±æ˜¾ç¤ºå‡ºäº†Balanceå’ŒTotal Supply

![screenshot](https://live.staticflickr.com/65535/52752408831_9857174404.jpg)

åœ¨ `useContractRead` åçš„ `<>` ä¸­æˆ‘ä»¬æŒ‡å®šäº†ä¸€äº›ç±»å‹ï¼ˆåŒ…æ‹¬è¿”å›å€¼ï¼‰

## ğŸ“ å†™å…¥æ•°æ®

å‘æˆ‘ä»¬çš„åˆçº¦å†™æ•°æ®çš„ä»£ç ä¸è¯»æ•°æ®æ²¡æœ‰è¶…çº§å¤§çš„åŒºåˆ«ã€‚ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼Œå½“æˆ‘ä»¬æƒ³å‘åˆçº¦å†™å…¥æ–°çš„æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€šçŸ¥çŸ¿å·¥ï¼Œä»¥ä¾¿äº¤æ˜“å¯ä»¥è¢«å¼€é‡‡ã€‚å½“æˆ‘ä»¬è¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿™æ ·åšã€‚è¯»å–æ˜¯ "å…è´¹ "çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ‰€åšçš„åªæ˜¯ä»åŒºå—é“¾ä¸Šè¯»å–ï¼Œ**æˆ‘ä»¬æ²¡æœ‰æ”¹å˜å®ƒã€‚**

ä¸‹é¢æ˜¯ mint çš„ä»£ç ï¼š

æˆ‘ä»¬åœ¨ `mounted` å®Œæˆå‰æ·»åŠ ä»¥ä¸‹ä»£ç 

```tsx
const { config } = usePrepareContractWrite({
  address: contractAddress,
  abi,
  functionName: "mint",
});
const { data, write: mint } = useContractWrite(config);
const { isError, isLoading, isSuccess } = useWaitForTransaction({
  hash: data?.hash,
});

useEffect(() => {
  setMounted(true);
}, []);
```

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ `usePrepareContractWrite`å‡½æ•° æ¥è·å–writeå‡½æ•°æ‰€éœ€è¦çš„é…ç½®å‚æ•°ã€‚è¿™é‡Œæˆ‘ä»¬æŒ‡å®šäº†åˆçº¦åœ°å€ã€ABIä»¥åŠè¦è°ƒç”¨çš„æ–¹æ³•åã€‚

æ¥ç€ï¼Œæˆ‘ä»¬å°†é…ç½®ä¼ å…¥ `useContractWrite` å°±å¯ä»¥è·å¾—åŒºå—é“¾å¯è¯†åˆ«çš„äº¤æ˜“æ•°æ® `data`ã€‚

å†é€šè¿‡ `useWaitForTransaction`å‡½æ•° å³å¯å®Œæˆè°ƒç”¨ã€‚

æˆ‘ä»¬è¿˜è¦åœ¨ mint å¡ç‰‡ä¸­æ·»åŠ æŒ‰é’®ä»¥ä¾¿å®Œæˆ mint è°ƒç”¨

```tsx
<div className={styles.card}>
  <div>Mint</div>
  <div>
    <button
      onClick={() => {
        mint?.();
      }}
    >
      Confirm
    </button>
  </div>
  {isSuccess && <div>Mint success</div>}
  {isError && <div>Mint error</div>}
</div>
```

å¾ˆç®€å•ï¼Œå¯¹å§ :)?

è¿™é‡Œæœ€æ£’çš„æ˜¯ï¼Œå½“äº¤æ˜“è¢«æŒ–å‡ºæ—¶ï¼Œä½ å®é™…ä¸Šå¯ä»¥æ‰“å°å‡ºäº¤æ˜“å“ˆå¸Œå€¼ï¼Œå°†å…¶å¤åˆ¶/ç²˜è´´åˆ° [Mumbai Polygonscan](https://mumbai.polygonscan.com/), å¹¶çœ‹åˆ°å®ƒæ­£åœ¨è¢«å®æ—¶å¤„ç† :)ã€‚

å½“æˆ‘ä»¬è¿è¡Œè¿™ä¸ªæ—¶ï¼Œä½ ä¼šçœ‹åˆ° Metamask å¼¹å‡ºå¹¶è¦æ±‚æˆ‘ä»¬æ”¯ä»˜ "Gas"ï¼Œæˆ‘ä»¬ç”¨æˆ‘ä»¬çš„å‡ç¾å…ƒæ”¯ä»˜ã€‚ æœ‰ä¸€ç¯‡å…³äºå®ƒçš„å¾ˆå¥½çš„æ–‡ç« [è¿™é‡Œ](https://ethereum.org/en/developers/docs/gas/). è¯•ç€å¼„æ¸…æ¥šä»€ä¹ˆæ˜¯ Gas:)ã€‚

æˆ‘ä»¬åˆ·æ–°é¡µé¢ä¼šå‘ç° balance å’Œ supply ä¹Ÿå¢åŠ äº†ï¼

## ğŸ‰ æˆåŠŸ

çœŸæ˜¯ä¸€ä¸ªå¥½ä¸œè¥¿ï¼æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå®é™…çš„å®¢æˆ·ç«¯ï¼Œå¯ä»¥è¯»å–å’Œå†™å…¥åŒºå—é“¾çš„æ•°æ®ã€‚ä»è¿™é‡Œï¼Œä½ å¯ä»¥åšä»»ä½•ä½ æƒ³åšçš„äº‹æƒ…ã€‚ä½ å·²ç»æœ‰äº†åŸºæœ¬çš„ä¸œè¥¿äº†ã€‚ä½ å¯ä»¥å»ºç«‹ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„ Twitter ç‰ˆæœ¬ã€‚ä½ å¯ä»¥å»ºç«‹ä¸€ç§æ–¹å¼ï¼Œè®©äººä»¬å‘å¸ƒä»–ä»¬æœ€å–œæ¬¢çš„å¤‡å¿˜å½•ï¼Œå¹¶å…è®¸äººä»¬ç”¨ ETH ç»™å‘å¸ƒæœ€ä½³å¤‡å¿˜å½•çš„äºº "æ‰“èµ"ã€‚ä½ å¯ä»¥å»ºç«‹ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„æŠ•ç¥¨ç³»ç»Ÿï¼Œä¸€ä¸ªå›½å®¶å¯ä»¥ç”¨å®ƒæ¥æŠ•ç¥¨é€‰ä¸¾ä¸€ä¸ªæ”¿æ²»å®¶ï¼Œåœ¨é‚£é‡Œä¸€åˆ‡éƒ½å…¬å¼€è€Œæ¸…æ™°ã€‚

å¯èƒ½æ€§ç¡®å®æ˜¯æ— ç©·æ— å°½çš„ã€‚
